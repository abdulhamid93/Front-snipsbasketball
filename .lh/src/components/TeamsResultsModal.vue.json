{
    "sourceFile": "src/components/TeamsResultsModal.vue",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1701428800288,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1701430804060,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,9 +77,9 @@\n         const route = useRoute();\r\n         // subscribe to channel\r\n         const echo = new LaravelEcho({\r\n             broadcaster: 'pusher',\r\n-            key: '46bb874b7ddecccc4d34',\r\n+            key: '6bc7ba1172f908246ab6',\r\n             cluster: 'eu',\r\n             encrypted: true,\r\n         });\r\n \r\n"
                }
            ],
            "date": 1701428800288,
            "name": "Commit-0",
            "content": "<template>\r\n    <div class=\"modal\" v-if=\"showModal\">\r\n        <div class=\"modal-content\">\r\n            <span class=\"close\" @click=\"closeModal\">&times;</span>\r\n            <h2 class=\"p-title\"><img src=\"https://app.snipsbasketball.com/storage/general/snips-logo.png\"\r\n                    alt=\"snipsbasketball\" height=\"80\">\r\n                <span style=\"margin-left: 20px;color:#df2020\">live Results:</span>\r\n            </h2>\r\n            <table>\r\n                <thead>\r\n                    <tr>\r\n                        <th style=\"width: 240px;\">Team Name</th>\r\n                        <th>Result</th>\r\n                        <!-- <th ></th> -->\r\n                        <th>%</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(team, index) in teams\" :key=\"index\">\r\n                        <td class=\"result-team\"> <img :src=\"team.logo\" width=\"36\"><span> {{ team.name }}</span></td>\r\n\r\n                        <td style=\"position: relative;\">\r\n                            <div class=\"bar-fill\" :style=\"{ width: calculatePercentage(team.total) + '%' }\"></div>\r\n                            {{ team.total.toFixed(0) }}\r\n                        </td>\r\n                        <td> {{ calculatePercentage(team.total) }}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { defineComponent, ref, onMounted } from 'vue';\r\nimport LaravelEcho from \"laravel-echo\"\r\nimport Pusher from 'pusher-js';\r\nimport { inject } from 'vue';\r\nimport eventBus from './../eventBus';\r\n\r\nimport { useRoute } from 'vue-router';\r\nimport { baseURL } from '@/config';\r\nimport moment from 'moment';\r\n\r\nexport default {\r\n\r\n    name: 'TeamsResultsModal',\r\n\r\n    data() {\r\n        return {\r\n            token: null,\r\n            tokenExists: false,\r\n            showModal: true,\r\n            teams: [\r\n            ],\r\n        };\r\n    },\r\n    props: {\r\n        openPopupInC2: Boolean, // Receive the prop indicating whether to open the popup\r\n    },\r\n    watch: {\r\n        openPopupInC2(newVal) {\r\n            this.showModal = newVal; // Update local state when the prop changes\r\n        },\r\n    },\r\n    created: function () {\r\n        this.teams = inject('teams');\r\n        // this.showModal = inject('openPopupInC2')\r\n        this.sortTeamsByTotal();\r\n    },\r\n\r\n    mounted: function () {\r\n        //     eventBus.on('open-popup-in-c2', function (showModal) {\r\n        //         this.showModal=showModal;\r\n        // });\r\n        const route = useRoute();\r\n        // subscribe to channel\r\n        const echo = new LaravelEcho({\r\n            broadcaster: 'pusher',\r\n            key: '46bb874b7ddecccc4d34',\r\n            cluster: 'eu',\r\n            encrypted: true,\r\n        });\r\n\r\n        // Subscribe to the 'vote-channel'\r\n        const channel = echo.channel('vote-channel');\r\n\r\n        // Listen for the 'vote.updated' event\r\n        channel.listen('.vote.updated', (event) => {\r\n            this.message = event.message;\r\n            this.results = event.teams.teams;\r\n            this.teams = event.teams.teams;\r\n\r\n            // Update the 'updated_at' field for each team\r\n            this.teams.forEach(team => {\r\n                team.updated_at = moment(team.updated_at).fromNow();\r\n            });\r\n\r\n            this.sortTeamsByTotal();\r\n        });\r\n\r\n    },\r\n    methods: {\r\n        closeModal() {\r\n            this.showModal = false;\r\n        },\r\n        calculatePercentage(total) {\r\n            const totalPoints = this.teams.reduce((total, team) => total + team.total, 0);\r\n            return ((total / totalPoints) * 100).toFixed(2);\r\n        },\r\n        sortTeamsByTotal() {\r\n            // Sort teams array by total property\r\n            this.teams.sort((a, b) => b.total - a.total);\r\n        }\r\n    },\r\n\r\n\r\n};\r\n\r\n\r\n\r\n</script>\r\n\r\n<style>\r\n.result-bar {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 20px;\r\n    background-color: #ddd;\r\n    display: inline-block;\r\n}\r\n\r\n.p-title {\r\n    margin-top: 10px;\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.bar-fill {\r\n    /* position: absolute; */\r\n    height: 20px;\r\n    /* background-color: #4caf50; */\r\n    transition: width 0.5s ease;\r\n    display: inline-block;\r\n}\r\n\r\n.result-team img {}\r\n\r\n.result-team span {\r\n    font-weight: 900;\r\n    margin-left: 15px;\r\n}\r\n\r\n/* Add your styling for the modal here */\r\n.modal {\r\n    display: block !important;\r\n    ;\r\n    position: fixed;\r\n    z-index: 1;\r\n    left: 0;\r\n    top: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: auto;\r\n    background-color: rgba(0, 0, 0, 0.4);\r\n}\r\n\r\n.modal-content {\r\n    background-color: #fefefe;\r\n    margin: 15% auto;\r\n    padding: 20px;\r\n    border: 1px solid #888;\r\n    width: 80%;\r\n    max-width: 800px;\r\n}\r\n\r\n.close {\r\n    color: #aaa;\r\n    float: right;\r\n    font-size: 28px;\r\n    font-weight: bold;\r\n}\r\n\r\n.close:hover,\r\n.close:focus {\r\n    color: black;\r\n    text-decoration: none;\r\n    cursor: pointer;\r\n}\r\n\r\ntable {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n    margin-top: 20px;\r\n}\r\n\r\nth,\r\ntd {\r\n    /* border: 1px solid #ddd; */\r\n    padding: 8px;\r\n    text-align: left;\r\n}\r\n\r\nth {\r\n    background-color: #f2f2f2;\r\n}\r\n\r\n.modal-content .close {\r\n    width: 20px;\r\n    position: absolute;\r\n    right: 10px;\r\n    top: 0;\r\n}</style>"
        }
    ]
}