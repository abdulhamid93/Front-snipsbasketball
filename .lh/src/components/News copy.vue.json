{
    "sourceFile": "src/components/News copy.vue",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1701428824439,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1701430804071,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,9 +29,9 @@\n   </section>\r\n   <div class=\"modal\" v-if=\"openPopupInC2\">\r\n     <div class=\"modal-content\">\r\n       <span class=\"close\" @click=\"closeModal\">&times;</span>\r\n-      <h2 class=\"p-title\"><img src=\"https://staging.snipsbasketball.com/storage/general/snips-logo.png\"\r\n+      <h2 class=\"p-title\"><img src=\"https://app.snipsbasketball.com/storage/general/snips-logo.png\"\r\n           alt=\"snipsbasketball\" height=\"80\">\r\n         <span style=\"margin-left: 20px;color:#df2020\">live Results:</span>\r\n       </h2>\r\n       <table>\r\n@@ -107,9 +107,9 @@\n \r\n     // subscribe to channel\r\n     const echo = new LaravelEcho({\r\n       broadcaster: 'pusher',\r\n-      key: '46bb874b7ddecccc4d34',\r\n+      key: '6bc7ba1172f908246ab6',\r\n       cluster: 'eu',\r\n       encrypted: true,\r\n     });\r\n \r\n"
                }
            ],
            "date": 1701428824439,
            "name": "Commit-0",
            "content": "\r\n<template>\r\n  <section class=\"news-container u-section-1-news\" id=\"\" data-image-width=\"1980\">\r\n\r\n    <div class=\"title\">\r\n      <a @click=\"openPopupRes\" class=\"page-logo\">\r\n        <img src=\"https://app.snipsbasketball.com/storage/general/snips-logo.png\" alt=\"snipsbasketball\" height=\"80\">\r\n        <span style=\"margin-left: 20px;color:#df2020\">live Results:</span>\r\n      </a>\r\n    </div>\r\n    <div class=\"team-carousel\">\r\n      <ul class=\"team-list\" :style=\"{ '--team-count': extendedTeams }\">\r\n      <li v-for=\"(team, index) in extendedTeams\" :key=\"index\" class=\"team-item\" :class=\"{ 'team-item-updated': team === changedTeam }\">\r\n        <div class=\"coin-container\">\r\n          <span class=\"ccpw_icon\">\r\n            <img :src=\"team.logo\" width=\"30\" height=\"30\" alt=\"team-logo\">\r\n          </span>\r\n          <div class=\"team-info\">\r\n            <span class=\"name\">{{ team.name }}</span>\r\n            <span class=\"total\">{{ team.total }}</span>\r\n          </div>\r\n          <!-- Add the green arrow if this is the changed team -->\r\n          <span v-if=\"team === changedTeam\" class=\"arrow-up\"></span>\r\n        </div>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  </section>\r\n  <div class=\"modal\" v-if=\"openPopupInC2\">\r\n    <div class=\"modal-content\">\r\n      <span class=\"close\" @click=\"closeModal\">&times;</span>\r\n      <h2 class=\"p-title\"><img src=\"https://staging.snipsbasketball.com/storage/general/snips-logo.png\"\r\n          alt=\"snipsbasketball\" height=\"80\">\r\n        <span style=\"margin-left: 20px;color:#df2020\">live Results:</span>\r\n      </h2>\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th style=\"width: 240px;\">Team Name</th>\r\n            <th>Result</th>\r\n            <!-- <th ></th> -->\r\n            <th>%</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"(team, index) in teams\" :key=\"index\">\r\n            <td class=\"result-team\"> <img :src=\"team.logo\" width=\"36\"><span> {{ team.name }}</span></td>\r\n\r\n            <td style=\"position: relative;\">\r\n              <div class=\"bar-fill\" :style=\"{ width: calculatePercentage(team.total) + '%' }\"></div>\r\n              {{ team.total.toFixed(0) }}\r\n            </td>\r\n            <td> {{ calculatePercentage(team.total) }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  </div>\r\n</template>\r\n  \r\n<script>\r\nimport { ref, watch } from 'vue';\r\nimport LaravelEcho from \"laravel-echo\"\r\nimport { inject } from 'vue';\r\nimport Pusher from 'pusher-js';\r\n\r\n// Enable pusher logging - don't include this in production\r\n// Pusher.logToConsole = true;\r\n\r\nimport eventBus from './../eventBus';\r\nimport { useRoute } from 'vue-router';\r\nexport default {\r\n\r\n  name: 'News',\r\n\r\n  data() {\r\n    return {\r\n      token: null,\r\n      tokenExists: false,\r\n      openPopupInC2: false,\r\n      teams: [\r\n      ],\r\n      changedTeam: null, // New property to store the changed team\r\n    };\r\n  },\r\n\r\n  created: function () {\r\n    this.teams = inject('teams');\r\n    this.sortTeamsByTotal();\r\n  },\r\n  computed: {\r\n    extendedTeams() {\r\n      // Duplicate the teams array to create a loop\r\n      return [...this.teams, ...this.teams];\r\n    },\r\n  },\r\n  mounted: function () {\r\n    const route = useRoute();\r\n    const token = ref('');\r\n    const tokenExists = ref(false);\r\n    token.value = route.params.token;\r\n    if (token.value !== undefined && token.value !== null && token.value !== '')\r\n      this.token = token.value;\r\n    console.log('token.value' + token.value);\r\n\r\n\r\n    // subscribe to channel\r\n    const echo = new LaravelEcho({\r\n      broadcaster: 'pusher',\r\n      key: '46bb874b7ddecccc4d34',\r\n      cluster: 'eu',\r\n      encrypted: true,\r\n    });\r\n\r\n    // Subscribe to the 'vote-channel'\r\n    const channel = echo.channel('vote-channel');\r\n\r\n    // Listen for the 'vote.updated' event\r\n    channel.listen('.vote.updated', (event) => {\r\n      this.teams = event.teams.teams;\r\n      this.sortTeamsByTotal();\r\n      // Set the changed team\r\n      const newChangedIndex = event.teams.teams.findIndex((team, index) => team.total !== this.teams[index].total);\r\n      this.changedTeam = event.teams.teams[newChangedIndex];\r\n\r\n      // Clear the changed team after 2 seconds\r\n      setTimeout(() => {\r\n        this.changedTeam = null;\r\n      }, 2000);\r\n    });\r\n\r\n    // Watch for changes in the total property of each team\r\n    watch(() => this.teams.map(team => team.total), (newTotalValues, oldTotalValues) => {\r\n      // Find the changed team based on the changed total value\r\n      const changedIndex = newTotalValues.findIndex((total, index) => total !== oldTotalValues[index]);\r\n      this.changedTeam = this.teams[changedIndex];\r\n      // console.log('Team total property changed!', this.changedTeam);\r\n\r\n      // Clear the changed team after 2 seconds\r\n      setTimeout(() => {\r\n        this.changedTeam = null;\r\n      }, 2000);\r\n\r\n    });\r\n\r\n  },\r\n  methods: {\r\n    closeModal() {\r\n      this.openPopupInC2 = false;\r\n    },\r\n    calculatePercentage(total) {\r\n      const totalPoints = this.teams.reduce((total, team) => total + team.total, 0);\r\n      return ((total / totalPoints) * 100).toFixed(2);\r\n    },\r\n    sortTeamsByTotal() {\r\n      // Sort teams array by total property\r\n      this.teams.sort((a, b) => b.total - a.total);\r\n    },\r\n    getTeamTextStyle(team) {\r\n      // Define styles for the changed team\r\n      if (team === this.changedTeam) {\r\n        return {\r\n          color: 'green',\r\n          fontWeight: 'bold',\r\n          fontSize: 'calc(2px + 100%)', // Increase font size by 2px\r\n        };\r\n      }\r\n      return {}; // Return an empty object for other teams\r\n    },\r\n    openPopupRes() {\r\n      \r\n      this.openPopupInC2=true; \r\n    },\r\n    initCarousel() {\r\n      const teamList = document.querySelector('.team-list');\r\n      teamList.innerHTML += teamList.innerHTML; // Duplicate the team list content\r\n      teamList.style.animation = `scrollTeams ${(teamList.offsetWidth / 40) * 2}px linear infinite`; // Adjust the duration\r\n    },\r\n  },\r\n\r\n};\r\n\r\n\r\n\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.team-carousel {\r\n  overflow: hidden;\r\n  width: 100%;\r\n}\r\n\r\n.team-list {\r\n  display: flex;\r\n}\r\n\r\n@keyframes scrollTeams {\r\n  0% {\r\n    transform: translateX(0);\r\n  }\r\n  100% {\r\n    transform: translateX(-100%);\r\n  }\r\n}\r\n\r\n.team-item {\r\n  margin-right: 10px; /* Adjust spacing between items */\r\n  overflow: hidden;\r\n  height: 50px; /* Adjusted item height */\r\n}\r\n\r\n.coin-container {\r\n  float: left;\r\n  list-style: none;\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.team-info {\r\n  margin-left: 5px; /* Adjust spacing between team logo and team info */\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.name {\r\n  font-size: 12px; /* Adjusted font size for team name */\r\n}\r\n\r\n.total {\r\n  font-size: 10px; /* Adjusted font size for total */\r\n}\r\n\r\n.ccw_icon img {\r\n  border-radius: 50%; /* Optional: Make the team logo circular */\r\n}\r\n\r\n.team-item-updated {\r\n  /* Styles for updated team item */\r\n}\r\n\r\n\r\n\r\n\r\n/* Example of additional styles for the changed team */\r\n.team-item-updated span {\r\n  color: green;\r\n  font-weight: bold;\r\n  font-size: calc(2px + 100%);\r\n  /* Increase font size by 2px */\r\n}\r\n\r\n.arrow-up {\r\n  position: absolute;\r\n  top: -8px;\r\n  /* Adjust this value to control the distance from the team total */\r\n  left: 50%;\r\n  /* Center the arrow horizontally */\r\n  margin-left: -5px;\r\n  /* Adjust this value to center the arrow properly */\r\n  width: 0;\r\n  height: 0;\r\n  border-left: 5px solid transparent;\r\n  border-right: 5px solid transparent;\r\n  border-bottom: 10px solid green;\r\n}\r\n\r\n.page-logo {\r\n  cursor: pointer;\r\n}\r\n</style>"
        }
    ]
}